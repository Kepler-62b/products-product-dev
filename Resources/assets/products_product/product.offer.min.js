let $btnAddOffer=document.getElementById("offer_addCollection");if($btnAddOffer){let $blockCollectionOffers=document.getElementById("collection-offer");$btnAddOffer.addEventListener("click",function(){let newForm=this.dataset.prototype;let index=this.dataset.index*1;newForm=newForm.replace(/__offers__/g,index);let div=document.createElement("div");div.classList.add("card");div.classList.add("mb-3");div.classList.add("w-100");div.id="item-collection-offer-"+index;div.innerHTML=newForm;$blockCollectionOffers.append(div);div.querySelector(".del-item-offer").addEventListener("click",deleteOffer);let $inputValue=div.querySelector("#product_form_offer_"+index+"_value");replaceReference($inputValue,"product_form_data-offer-reference");div.querySelector(".offer-image-add-collection")?.addEventListener("click",addOfferImage);let $changeRoot=div.querySelector('[class^="change-root-"]');if($changeRoot){$changeRoot.checked=true;$changeRoot.addEventListener("change",chanheOfferImageRoot)}div.querySelector(".del-item-offer-image")?.addEventListener("click",deleteOfferImage);div.scrollIntoView({block:"center",inline:"center",behavior:"smooth"});this.dataset.index=(index+1).toString();div.querySelector(".del-item-variation").addEventListener("click",deleteVariation);let $inputValueVariation=div.querySelector("#product_form_offer_"+index+"_variation_0_value");replaceReference($inputValueVariation,"product_form_data-variation-reference");div.querySelector(".variation-image-add-collection")?.addEventListener("click",addVariationImage);div.querySelector(".del-item-variation-image")?.addEventListener("click",deleteVariationImage);let changeRadio=div.querySelector(".change-variation-product_form_offer_"+index+"_variation_0");if(changeRadio){changeRadio.checked=true;changeRadio.addEventListener("change",chanheVariationImageRoot)}div.querySelector(".offer-variation-add-collection").addEventListener("click",addVariation);offerPreloadPhoto(div)})}document.querySelectorAll(".del-item-offer").forEach(function(item){item.addEventListener("click",deleteOffer)});function deleteOffer(){document.getElementById("item-collection-offer-"+this.dataset.index).remove()}document.querySelectorAll(".offer-image-add-collection").forEach(function(item){item.addEventListener("click",addOfferImage)});function addOfferImage(){let newForm=this.dataset.prototype;let index=this.dataset.index*1;let offer=this.dataset.offer*1;newForm=newForm.replace(/__offers__/g,offer);newForm=newForm.replace(/__offer_image__/g,index);let div=document.createElement("div");div.innerHTML=newForm;div.id="item_product_form_offer_"+offer+"_image_"+index;$offerImageCollection=document.getElementById("offer_image_collection-"+offer);$offerImageCollection.append(div);div.querySelector(".del-item-offer-image").addEventListener("click",deleteOfferImage);div.querySelector(".change-root-"+offer).addEventListener("change",chanheOfferImageRoot);this.dataset.index=(index+1).toString();let inputElement=div.querySelector('input[type="file"]');inputElement.addEventListener("change",function(e){var file=inputElement.files[0];var reader=new FileReader;let image=div.querySelector(".image-input");reader.onloadend=function(){image.style.setProperty("background-image","url("+reader.result+")","important")};if(file){reader.readAsDataURL(file)}else{image.style.setProperty("background-image","url(/img/blank.svg)","important")}})}document.querySelectorAll(".del-item-offer-image").forEach(function(item){item.addEventListener("click",deleteOfferImage)});function deleteOfferImage(){let btnRootId=this.id.replace(/DeleteOfferPhoto/g,"root");let btnRoot=document.getElementById(btnRootId);let photoBlock=document.getElementById(this.dataset.index);let parentElement=photoBlock.parentElement;photoBlock.remove();if(btnRoot){if(btnRoot.checked==true){let nextChaecked=parentElement.querySelector('[class^="change-root-"]');if(nextChaecked){nextChaecked.checked=true}}}}document.querySelectorAll('[class^="change-root-"]').forEach(function(item){item.addEventListener("change",chanheOfferImageRoot)});function chanheOfferImageRoot(){let offer_photo_collection=document.getElementById("offer_image_collection-"+this.dataset.index);offer_photo_collection.querySelectorAll(".change-root-"+this.dataset.index).forEach(function(rootChack,i,arr){rootChack.checked=false});this.checked=true}document.querySelectorAll(".offer-variation-add-collection").forEach(function(item){item.addEventListener("click",addVariation)});function addVariation(){let newForm=this.dataset.prototype;let index=this.dataset.index*1;let offer=this.dataset.offer*1;newForm=newForm.replace(/__offers__/g,offer);newForm=newForm.replace(/__offer_variation__/g,index);let div=document.createElement("div");div.innerHTML=newForm;div.id="item_product_form_offer_"+offer+"_variation_"+index;div.querySelector(".del-item-variation").addEventListener("click",deleteVariation);let $inputValue=div.querySelector("#product_form_offer_"+offer+"_variation_"+index+"_value");replaceReference($inputValue,"product_form_data-variation-reference");div.querySelector(".variation-image-add-collection")?.addEventListener("click",addVariationImage);div.querySelector(".del-item-variation-image")?.addEventListener("click",deleteVariationImage);let changeRadio=div.querySelector(".change-variation-product_form_offer_"+offer+"_variation_"+index);if(changeRadio){changeRadio.checked=true;changeRadio.addEventListener("change",chanheVariationImageRoot)}let $collection=document.getElementById(this.dataset.collection);$collection.append(div);offerPreloadPhoto(div);this.dataset.index=(index+1).toString()}document.querySelectorAll(".del-item-variation").forEach(function(item){item.addEventListener("click",deleteVariation)});function deleteVariation(){document.getElementById(this.dataset.index).remove()}document.querySelectorAll(".variation-image-add-collection").forEach(function(item){item.addEventListener("click",addVariationImage)});function addVariationImage(){let newForm=this.dataset.prototype;let index=this.dataset.index*1;let offer=this.dataset.offer*1;let variation=this.dataset.variation*1;let id=this.dataset.id;newForm=newForm.replace(/__offers__/g,offer);newForm=newForm.replace(/__offer_variation__/g,variation);newForm=newForm.replace(/__variation_image__/g,index);let div=document.createElement("div");div.innerHTML=newForm;div.id="item_product_form_offer_"+offer+"_variation_"+variation+"_image_"+index;let $collection=document.getElementById("collection_"+id);$collection.append(div);div.querySelector(".del-item-variation-image").addEventListener("click",deleteVariationImage);div.querySelector(".change-variation-"+id).addEventListener("change",chanheVariationImageRoot);offerPreloadPhoto(div);this.dataset.index=(index+1).toString()}document.querySelectorAll(".del-item-variation-image").forEach(function(item){item.addEventListener("click",deleteVariationImage)});function deleteVariationImage(){let btnRootId=this.id.replace(/DeleteVariationPhoto/g,"root");let btnRoot=document.getElementById(btnRootId);let photoBlock=document.getElementById(this.dataset.index);let parentElement=photoBlock.parentElement;photoBlock.remove();if(btnRoot){if(btnRoot.checked==true){let nextChaecked=parentElement.querySelector('[class^="change-variation-"]');if(nextChaecked){nextChaecked.checked=true}}}}document.querySelectorAll('[class^="change-variation-"]').forEach(function(item){item.addEventListener("change",chanheVariationImageRoot)});function chanheVariationImageRoot(){let variation_photo_collection=document.getElementById("collection_"+this.dataset.index);variation_photo_collection.querySelectorAll(".change-variation-"+this.dataset.index).forEach(function(rootChack,i,arr){rootChack.checked=false});this.checked=true}function offerPreloadPhoto(div){let inputElements=div.querySelectorAll('input[type="file"]');inputElements.forEach(function(inputElement,i,arr){inputElement.addEventListener("change",function(e){var file=this.files[0];var reader=new FileReader;let image=this.closest(".image-input");reader.onloadend=function(){image.style.setProperty("background-image","url("+reader.result+")","important")};if(file){reader.readAsDataURL(file)}else{image.style.setProperty("background-image","url(/img/blank.svg)","important")}})})}function replaceReference($replace,$id){let $reference=document.getElementById($id);if($reference===null||$reference.tagName!="SELECT"){return}if($reference){let cloneNode=$reference.cloneNode(true);cloneNode.id=$replace.id;cloneNode.name=$replace.name;cloneNode.value="";if(cloneNode.options!==undefined){cloneNode.options[0].selected=true;cloneNode.options[0].selected="selected";cloneNode.selectedIndex=0;for(let i=0,l=cloneNode.options.length;i<l;i++){cloneNode.options[i].removeAttribute("selected");cloneNode.options[i].selected=false}}$replace.replaceWith(cloneNode);new NiceSelect(cloneNode,{searchable:true})}}